# é¡¹ç›®éƒ¨ç½²æŒ‡å—

## ğŸš€ éƒ¨ç½²æ¶æ„æ¦‚è§ˆ

### ç¯å¢ƒè§„åˆ’
```
å¼€å‘ç¯å¢ƒ (Development)
â”œâ”€â”€ æœ¬åœ°å¼€å‘ç¯å¢ƒ (Local)
â”œâ”€â”€ å¼€å‘æœåŠ¡å™¨ (Dev Server)
â””â”€â”€ åŠŸèƒ½æµ‹è¯•ç¯å¢ƒ (Feature Test)

æµ‹è¯•ç¯å¢ƒ (Testing)
â”œâ”€â”€ é›†æˆæµ‹è¯•ç¯å¢ƒ (Integration Test)
â”œâ”€â”€ æ€§èƒ½æµ‹è¯•ç¯å¢ƒ (Performance Test)
â””â”€â”€ ç”¨æˆ·éªŒæ”¶æµ‹è¯•ç¯å¢ƒ (UAT)

ç”Ÿäº§ç¯å¢ƒ (Production)
â”œâ”€â”€ é¢„ç”Ÿäº§ç¯å¢ƒ (Pre-Production)
â””â”€â”€ ç”Ÿäº§ç¯å¢ƒ (Production)
```

### åŸºç¡€è®¾æ–½æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        è´Ÿè½½å‡è¡¡å±‚                            â”‚
â”‚  Nginx + Keepalived (é«˜å¯ç”¨)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åº”ç”¨å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ API Gateway â”‚  â”‚ Webåº”ç”¨     â”‚  â”‚ ç§»åŠ¨ç«¯API   â”‚        â”‚
â”‚  â”‚ (å¤šå®ä¾‹)    â”‚  â”‚ (å¤šå®ä¾‹)    â”‚  â”‚ (å¤šå®ä¾‹)    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æœåŠ¡å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ ç”¨æˆ·æœåŠ¡    â”‚  â”‚ æ•°æ®æœåŠ¡    â”‚  â”‚ åˆ†ææœåŠ¡    â”‚        â”‚
â”‚  â”‚ (é›†ç¾¤)      â”‚  â”‚ (é›†ç¾¤)      â”‚  â”‚ (é›†ç¾¤)      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ MySQLä¸»ä»   â”‚  â”‚ Redisé›†ç¾¤   â”‚  â”‚ RabbitMQ    â”‚        â”‚
â”‚  â”‚ (è¯»å†™åˆ†ç¦»)  â”‚  â”‚ (å“¨å…µæ¨¡å¼)  â”‚  â”‚ (é›†ç¾¤æ¨¡å¼)  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ³ Dockerå®¹å™¨åŒ–éƒ¨ç½²

### Dockerfileè§„èŒƒ
```dockerfile
# åç«¯æœåŠ¡Dockerfile
FROM openjdk:11-jre-slim

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# åˆ›å»ºåº”ç”¨ç”¨æˆ·
RUN groupadd -r appuser && useradd -r -g appuser appuser

# å¤åˆ¶åº”ç”¨æ–‡ä»¶
COPY target/business-analysis-*.jar app.jar

# è®¾ç½®æ–‡ä»¶æƒé™
RUN chown -R appuser:appuser /app

# åˆ‡æ¢åˆ°åº”ç”¨ç”¨æˆ·
USER appuser

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s --start-period=60s --retries=3 \
  CMD curl -f http://localhost:8080/actuator/health || exit 1

# æš´éœ²ç«¯å£
EXPOSE 8080

# JVMå‚æ•°ä¼˜åŒ–
ENV JAVA_OPTS="-Xms512m -Xmx1024m -XX:+UseG1GC -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/app/logs/"

# å¯åŠ¨å‘½ä»¤
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -Djava.security.egd=file:/dev/./urandom -jar app.jar"]
```

```dockerfile
# å‰ç«¯åº”ç”¨Dockerfile
FROM node:18-alpine AS builder

WORKDIR /app

# å¤åˆ¶packageæ–‡ä»¶
COPY package*.json ./

# å®‰è£…ä¾èµ–
RUN npm ci --only=production

# å¤åˆ¶æºç 
COPY . .

# æ„å»ºåº”ç”¨
RUN npm run build

# ç”Ÿäº§é•œåƒ
FROM nginx:alpine

# å¤åˆ¶æ„å»ºäº§ç‰©
COPY --from=builder /app/dist /usr/share/nginx/html

# å¤åˆ¶nginxé…ç½®
COPY nginx.conf /etc/nginx/nginx.conf

# æš´éœ²ç«¯å£
EXPOSE 80

# å¯åŠ¨nginx
CMD ["nginx", "-g", "daemon off;"]
```

### Docker Composeé…ç½®
```yaml
# docker-compose.yml
version: '3.8'

services:
  # MySQLæ•°æ®åº“
  mysql:
    image: mysql:8.0
    container_name: business-analysis-mysql
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: business_analysis
      MYSQL_USER: ${MYSQL_USER}
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql
      - ./sql/init.sql:/docker-entrypoint-initdb.d/init.sql
    command: --default-authentication-plugin=mysql_native_password
    restart: unless-stopped
    networks:
      - business-network
    
  # Redisç¼“å­˜
  redis:
    image: redis:6.0-alpine
    container_name: business-analysis-redis
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
      - ./redis/redis.conf:/usr/local/etc/redis/redis.conf
    command: redis-server /usr/local/etc/redis/redis.conf
    restart: unless-stopped
    networks:
      - business-network
    
  # RabbitMQæ¶ˆæ¯é˜Ÿåˆ—
  rabbitmq:
    image: rabbitmq:3.8-management
    container_name: business-analysis-rabbitmq
    environment:
      RABBITMQ_DEFAULT_USER: ${RABBITMQ_USER}
      RABBITMQ_DEFAULT_PASS: ${RABBITMQ_PASSWORD}
    ports:
      - "5672:5672"
      - "15672:15672"
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq
    restart: unless-stopped
    networks:
      - business-network
    
  # APIç½‘å…³
  gateway:
    build:
      context: ./business-analysis-gateway
      dockerfile: Dockerfile
    container_name: business-analysis-gateway
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE=http://eureka:8761/eureka
    ports:
      - "8080:8080"
    depends_on:
      - eureka
      - redis
    restart: unless-stopped
    networks:
      - business-network
    
  # ç”¨æˆ·æœåŠ¡
  user-service:
    build:
      context: ./business-analysis-modules/user-service
      dockerfile: Dockerfile
    container_name: business-analysis-user-service
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - DB_HOST=mysql
      - DB_PORT=3306
      - DB_NAME=business_analysis
      - DB_USERNAME=${MYSQL_USER}
      - DB_PASSWORD=${MYSQL_PASSWORD}
      - REDIS_HOST=redis
      - REDIS_PORT=6379
    depends_on:
      - mysql
      - redis
      - eureka
    restart: unless-stopped
    networks:
      - business-network
    
  # æ•°æ®æœåŠ¡
  data-service:
    build:
      context: ./business-analysis-modules/data-service
      dockerfile: Dockerfile
    container_name: business-analysis-data-service
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - DB_HOST=mysql
      - REDIS_HOST=redis
      - RABBITMQ_HOST=rabbitmq
    depends_on:
      - mysql
      - redis
      - rabbitmq
      - eureka
    restart: unless-stopped
    networks:
      - business-network
    
  # å‰ç«¯åº”ç”¨
  web-app:
    build:
      context: ./business-analysis-web
      dockerfile: Dockerfile
    container_name: business-analysis-web
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./nginx/ssl:/etc/nginx/ssl
    depends_on:
      - gateway
    restart: unless-stopped
    networks:
      - business-network

# ç½‘ç»œé…ç½®
networks:
  business-network:
    driver: bridge

# æ•°æ®å·é…ç½®
volumes:
  mysql_data:
    driver: local
  redis_data:
    driver: local
  rabbitmq_data:
    driver: local
```

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# .env
# æ•°æ®åº“é…ç½®
MYSQL_ROOT_PASSWORD=root123456
MYSQL_USER=business_user
MYSQL_PASSWORD=business_password

# Redisé…ç½®
REDIS_PASSWORD=redis123456

# RabbitMQé…ç½®
RABBITMQ_USER=admin
RABBITMQ_PASSWORD=admin123456

# åº”ç”¨é…ç½®
SPRING_PROFILES_ACTIVE=docker
JWT_SECRET=business-analysis-jwt-secret-key-2024
API_BASE_URL=https://api.business-analysis.com

# ç›‘æ§é…ç½®
PROMETHEUS_ENABLED=true
GRAFANA_ADMIN_PASSWORD=grafana123456

# æ—¥å¿—é…ç½®
LOG_LEVEL=INFO
LOG_PATH=/app/logs
```

## â˜¸ï¸ Kuberneteséƒ¨ç½²

### å‘½åç©ºé—´é…ç½®
```yaml
# namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: business-analysis
  labels:
    name: business-analysis
    environment: production
```

### ConfigMapé…ç½®
```yaml
# configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: business-analysis-config
  namespace: business-analysis
data:
  application.yml: |
    spring:
      datasource:
        url: jdbc:mysql://mysql-service:3306/business_analysis
        username: ${DB_USERNAME}
        password: ${DB_PASSWORD}
      redis:
        host: redis-service
        port: 6379
        password: ${REDIS_PASSWORD}
      rabbitmq:
        host: rabbitmq-service
        port: 5672
        username: ${RABBITMQ_USERNAME}
        password: ${RABBITMQ_PASSWORD}
    
    logging:
      level:
        root: INFO
        com.company.businessanalysis: INFO
      file:
        name: /app/logs/application.log
    
    management:
      endpoints:
        web:
          exposure:
            include: health,info,metrics,prometheus
```

### Secreté…ç½®
```yaml
# secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: business-analysis-secret
  namespace: business-analysis
type: Opaque
data:
  # Base64ç¼–ç çš„æ•æ„Ÿä¿¡æ¯
  db-username: YnVzaW5lc3NfdXNlcg==  # business_user
  db-password: YnVzaW5lc3NfcGFzc3dvcmQ=  # business_password
  redis-password: cmVkaXMxMjM0NTY=  # redis123456
  rabbitmq-username: YWRtaW4=  # admin
  rabbitmq-password: YWRtaW4xMjM0NTY=  # admin123456
  jwt-secret: YnVzaW5lc3MtYW5hbHlzaXMtand0LXNlY3JldC1rZXktMjAyNA==
```

### Deploymenté…ç½®
```yaml
# deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: business-analysis-api
  namespace: business-analysis
  labels:
    app: business-analysis-api
    version: v1.0.0
spec:
  replicas: 3
  selector:
    matchLabels:
      app: business-analysis-api
  template:
    metadata:
      labels:
        app: business-analysis-api
        version: v1.0.0
    spec:
      containers:
      - name: api
        image: business-analysis/api:1.0.0
        ports:
        - containerPort: 8080
          name: http
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "k8s"
        - name: DB_USERNAME
          valueFrom:
            secretKeyRef:
              name: business-analysis-secret
              key: db-username
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: business-analysis-secret
              key: db-password
        - name: REDIS_PASSWORD
          valueFrom:
            secretKeyRef:
              name: business-analysis-secret
              key: redis-password
        - name: JWT_SECRET
          valueFrom:
            secretKeyRef:
              name: business-analysis-secret
              key: jwt-secret
        
        # èµ„æºé™åˆ¶
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "1Gi"
            cpu: "1000m"
        
        # å¥åº·æ£€æŸ¥
        livenessProbe:
          httpGet:
            path: /actuator/health
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 30
          timeoutSeconds: 5
          failureThreshold: 3
        
        readinessProbe:
          httpGet:
            path: /actuator/health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 3
          failureThreshold: 3
        
        # å­˜å‚¨å·æŒ‚è½½
        volumeMounts:
        - name: config-volume
          mountPath: /app/config
        - name: logs-volume
          mountPath: /app/logs
        
      volumes:
      - name: config-volume
        configMap:
          name: business-analysis-config
      - name: logs-volume
        emptyDir: {}
      
      # é•œåƒæ‹‰å–ç­–ç•¥
      imagePullPolicy: IfNotPresent
      
      # é‡å¯ç­–ç•¥
      restartPolicy: Always
```

### Serviceé…ç½®
```yaml
# service.yaml
apiVersion: v1
kind: Service
metadata:
  name: business-analysis-api-service
  namespace: business-analysis
  labels:
    app: business-analysis-api
spec:
  type: ClusterIP
  ports:
  - port: 8080
    targetPort: 8080
    protocol: TCP
    name: http
  selector:
    app: business-analysis-api

---
# è´Ÿè½½å‡è¡¡æœåŠ¡
apiVersion: v1
kind: Service
metadata:
  name: business-analysis-api-lb
  namespace: business-analysis
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: nlb
spec:
  type: LoadBalancer
  ports:
  - port: 80
    targetPort: 8080
    protocol: TCP
  selector:
    app: business-analysis-api
```

### Ingressé…ç½®
```yaml
# ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: business-analysis-ingress
  namespace: business-analysis
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
    nginx.ingress.kubernetes.io/rate-limit: "100"
    cert-manager.io/cluster-issuer: letsencrypt-prod
spec:
  tls:
  - hosts:
    - api.business-analysis.com
    - app.business-analysis.com
    secretName: business-analysis-tls
  rules:
  - host: api.business-analysis.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: business-analysis-api-service
            port:
              number: 8080
  - host: app.business-analysis.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: business-analysis-web-service
            port:
              number: 80
```

## ğŸ“Š ç›‘æ§ä¸æ—¥å¿—

### Prometheusç›‘æ§é…ç½®
```yaml
# prometheus-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: prometheus-config
  namespace: business-analysis
data:
  prometheus.yml: |
    global:
      scrape_interval: 15s
      evaluation_interval: 15s
    
    rule_files:
      - "/etc/prometheus/rules/*.yml"
    
    scrape_configs:
      # åº”ç”¨ç›‘æ§
      - job_name: 'business-analysis-api'
        static_configs:
          - targets: ['business-analysis-api-service:8080']
        metrics_path: '/actuator/prometheus'
        scrape_interval: 30s
      
      # æ•°æ®åº“ç›‘æ§
      - job_name: 'mysql'
        static_configs:
          - targets: ['mysql-exporter:9104']
      
      # Redisç›‘æ§
      - job_name: 'redis'
        static_configs:
          - targets: ['redis-exporter:9121']
      
      # Kubernetesç›‘æ§
      - job_name: 'kubernetes-pods'
        kubernetes_sd_configs:
          - role: pod
        relabel_configs:
          - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]
            action: keep
            regex: true
    
    alerting:
      alertmanagers:
        - static_configs:
            - targets: ['alertmanager:9093']
```

### å‘Šè­¦è§„åˆ™é…ç½®
```yaml
# alert-rules.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: prometheus-rules
  namespace: business-analysis
data:
  business-analysis.yml: |
    groups:
    - name: business-analysis-alerts
      rules:
      # åº”ç”¨å¯ç”¨æ€§å‘Šè­¦
      - alert: ApplicationDown
        expr: up{job="business-analysis-api"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "åº”ç”¨æœåŠ¡ä¸å¯ç”¨"
          description: "{{ $labels.instance }} åº”ç”¨æœåŠ¡å·²åœæ­¢å“åº”è¶…è¿‡1åˆ†é’Ÿ"
      
      # é«˜é”™è¯¯ç‡å‘Šè­¦
      - alert: HighErrorRate
        expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.1
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "åº”ç”¨é”™è¯¯ç‡è¿‡é«˜"
          description: "{{ $labels.instance }} 5xxé”™è¯¯ç‡è¶…è¿‡10%"
      
      # å“åº”æ—¶é—´å‘Šè­¦
      - alert: HighResponseTime
        expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 1
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "åº”ç”¨å“åº”æ—¶é—´è¿‡é•¿"
          description: "{{ $labels.instance }} 95%è¯·æ±‚å“åº”æ—¶é—´è¶…è¿‡1ç§’"
      
      # å†…å­˜ä½¿ç”¨ç‡å‘Šè­¦
      - alert: HighMemoryUsage
        expr: (container_memory_usage_bytes / container_spec_memory_limit_bytes) * 100 > 80
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜"
          description: "{{ $labels.instance }} å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡80%"
      
      # CPUä½¿ç”¨ç‡å‘Šè­¦
      - alert: HighCPUUsage
        expr: (rate(container_cpu_usage_seconds_total[5m]) * 100) > 80
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "CPUä½¿ç”¨ç‡è¿‡é«˜"
          description: "{{ $labels.instance }} CPUä½¿ç”¨ç‡è¶…è¿‡80%"
      
      # æ•°æ®åŒæ­¥å¤±è´¥å‘Šè­¦
      - alert: DataSyncFailure
        expr: increase(data_sync_failures_total[1h]) > 0
        for: 0m
        labels:
          severity: critical
        annotations:
          summary: "æ•°æ®åŒæ­¥ä»»åŠ¡å¤±è´¥"
          description: "æ•°æ®åŒæ­¥ä»»åŠ¡åœ¨è¿‡å»1å°æ—¶å†…å¤±è´¥äº† {{ $value }} æ¬¡"
      
      # æ•°æ®åº“è¿æ¥å‘Šè­¦
      - alert: DatabaseConnectionFailure
        expr: mysql_up == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "æ•°æ®åº“è¿æ¥å¤±è´¥"
          description: "æ— æ³•è¿æ¥åˆ°MySQLæ•°æ®åº“"
```

### Grafanaä»ªè¡¨æ¿é…ç½®
```json
{
  "dashboard": {
    "id": null,
    "title": "ç»è¥åˆ†æAPPç›‘æ§ä»ªè¡¨æ¿",
    "tags": ["business-analysis"],
    "timezone": "browser",
    "panels": [
      {
        "id": 1,
        "title": "åº”ç”¨çŠ¶æ€æ¦‚è§ˆ",
        "type": "stat",
        "targets": [
          {
            "expr": "up{job=\"business-analysis-api\"}",
            "legendFormat": "æœåŠ¡çŠ¶æ€"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {"color": "red", "value": 0},
                {"color": "green", "value": 1}
              ]
            }
          }
        }
      },
      {
        "id": 2,
        "title": "è¯·æ±‚QPS",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(http_requests_total[5m])",
            "legendFormat": "QPS"
          }
        ]
      },
      {
        "id": 3,
        "title": "å“åº”æ—¶é—´åˆ†å¸ƒ",
        "type": "graph",
        "targets": [
          {
            "expr": "histogram_quantile(0.50, rate(http_request_duration_seconds_bucket[5m]))",
            "legendFormat": "P50"
          },
          {
            "expr": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))",
            "legendFormat": "P95"
          },
          {
            "expr": "histogram_quantile(0.99, rate(http_request_duration_seconds_bucket[5m]))",
            "legendFormat": "P99"
          }
        ]
      }
    ],
    "time": {
      "from": "now-1h",
      "to": "now"
    },
    "refresh": "30s"
  }
}
```
